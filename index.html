<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>34 DIVERSE // INFINITE_BREACH</title>
    <style>
        body { background-color: #050a14; color: #60a5fa; font-family: 'Courier New', monospace; margin: 0; padding: 20px; }
        .terminal-header { border-bottom: 2px solid #1e3a8a; padding-bottom: 20px; text-align: center; position: sticky; top: 0; background: #050a14; z-index: 100; }
        h1 { color: #22c55e; letter-spacing: 5px; text-shadow: 0 0 10px #22c55e; margin: 0; }
        #query { background: #0d1626; border: 1px solid #1e3a8a; color: #22c55e; padding: 12px; width: 300px; outline: none; }
        .btn { background: #1e3a8a; color: white; border: 1px solid #60a5fa; padding: 12px 25px; cursor: pointer; font-weight: bold; }
        
        #intel-feed { margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; }
        .intel-card { border: 1px solid #1e3a8a; background: #000; overflow: hidden; display: flex; flex-direction: column; }
        .viewport { width: 100%; position: relative; padding-top: 56.25%; background: #050a14; }
        .viewport iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .card-content { padding: 15px; background: rgba(13, 22, 38, 0.95); }
        .result-title { color: #22c55e; font-size: 14px; text-decoration: none; font-weight: bold; }

        /* PAGINATION STYLING */
        #pagination-control { text-align: center; padding: 40px; display: none; }
        .load-btn { background: #22c55e; color: #050a14; border: none; padding: 15px 40px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .load-btn:hover { background: #16a34a; box-shadow: 0 0 15px #22c55e; }
    </style>
</head>
<body>

    <div class="terminal-header">
        <h1>34 DIVERSE</h1>
        <p>> [SECTOR]: <span id="current-sector">READY</span> | [PAGE]: <span id="page-num">1</span></p>
        <input type="text" id="query" placeholder="IDENTIFY TARGET...">
        <button class="btn" onclick="initialSearch()">START EXTRACTION</button>
    </div>

    <div id="intel-feed"></div>

    <div id="pagination-control">
        <button class="load-btn" onclick="fetchNextWave()">REQUEST NEXT WAVE</button>
    </div>

    <script>
        let currentPage = 1;
        let lastQuery = "";

        // Reset for a brand new search
        function initialSearch() {
            const q = document.getElementById('query').value;
            if(!q) return;
            
            lastQuery = q;
            currentPage = 1;
            document.getElementById('intel-feed').innerHTML = "";
            document.getElementById('page-num').innerText = currentPage;
            executeBreach();
        }

        // Fetch the next set of results
        function fetchNextWave() {
            currentPage++;
            document.getElementById('page-num').innerText = currentPage;
            executeBreach();
        }

        async function executeBreach() {
            const feed = document.getElementById('intel-feed');
            const status = document.getElementById('current-sector');
            status.innerText = "EXTRACTING WAVE " + currentPage;

            // Invidious API uses the 'page' parameter for pagination
            const url = `https://vid.priv.au/api/v1/search?q=${encodeURIComponent(lastQuery)}&page=${currentPage}`;

            try {
                const response = await fetch(url);
                const results = await response.json();

                if (results.length === 0) {
                    status.innerText = "END OF DATA";
                    document.getElementById('pagination-control').style.display = "none";
                    return;
                }

                results.forEach(item => {
                    if(item.type !== "video") return;

                    const card = document.createElement('div');
                    card.className = 'intel-card';
                    card.innerHTML = `
                        <div class="viewport">
                            <iframe src="https://www.youtube.com/embed/${item.videoId}" allowfullscreen loading="lazy"></iframe>
                        </div>
                        <div class="card-content">
                            <a class="result-title" href="https://youtube.com/watch?v=${item.videoId}" target="_blank">${item.title}</a>
                        </div>`;
                    feed.appendChild(card);
                });

                // Reveal the "Load More" button after the first wave pops
                document.getElementById('pagination-control').style.display = "block";
                status.innerText = "SIGNAL_CLEAN";

            } catch (e) {
                status.innerText = "CONNECTION_FAIL";
                console.error(e);
            }
        }
    </script>
</body>
</html>
